---
// src/components/ThemeSwitcher.astro
import ThemeIcon from './ThemeIcon.astro';

const themes = ['square', 'neobrutalist', 'liquid-glass'] as const;
---
<div id="theme-switcher-container" class="absolute top-0 left-0" data-state="closed">
  <div id="theme-flex-container" class="flex items-center justify-center border border-text/50 rounded-btn transition-all duration-300 ease-in-out">
    {themes.map((theme) => (
      <button 
        type="button"
        data-theme-button={theme}
        class="theme-button p-1.5"
        aria-label={`Cambiar a tema ${theme}`}
      >
        <ThemeIcon theme={theme} />
      </button>
    ))}
  </div>
</div>

<style>
  #theme-flex-container {
    /* El contenedor se ajusta al botón activo cuando está cerrado */
    width: auto;
  }
  
  .theme-button {
    transition: all 0.3s ease-in-out;
  }
  
  /* Por defecto, los botones inactivos están totalmente ocultos */
  .theme-button:not([data-active='true']) {
    width: 0;
    padding: 0;
    opacity: 0;
    scale: 0.5;
    pointer-events: none; /* Evita clics fantasma */
  }

  /* Cuando el switcher se abre... */
  #theme-switcher-container[data-state='open'] #theme-flex-container {
     /* Le damos un ancho fijo para que quepan todos los botones */
    width: 8rem; /* 128px */
  }

  #theme-switcher-container[data-state='open'] .theme-button {
    /* Hacemos visibles todos los botones */
    width: auto;
    padding: 0.375rem; /* p-1.5 */
    opacity: 1;
    scale: 1;
    pointer-events: auto;
  }
</style>